<!--This is for people to put in their weekly preferences-->

<!-- Main page after logging in, shows an employee's schedule for the week/month-->
<!DOCTYPE html>
<html lang='en'>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title> Manage </title>

    <!-- Bootstrap core CSS -->
    <link href="../static/vendor/bootstrap/css/bootstrap.css" rel="stylesheet">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>

<body class="body">
    {% include 'header.html' %}

    <!-- Page Content -->
    <div class=" p-md-3">
        <div class="col-md-8 order-md-1 mx-auto">
            <h1 class="display-4 font-weight-normal">Manage {{groupname}} {% if notgroupintitle %} Group {% endif %}
            </h1>
            <hr>
        </div>
    </div>

    <div class="col-md-8 order-md-1 mx-auto">
        <div class="container">
            <span id="shifts"></span>
            <h2 class="mb-3"> Current Shifts</h2>
            {% if shifts|length > 0 %}
            <p>Schedules for <strong>{{groupname}}</strong> will be generated using these shifts. <br>

                {% for i in shifts %}
            <form action='' method="post">
                <div class="row">
                    <div class="col">
                        <strong>Day: </strong>{{shifts[i][0]}}
                    </div>
                    <div class="col">
                        <strong>Start: </strong>{{shifts[i][1]}}
                    </div>
                    <div class="col">
                        <strong>End: </strong>{{shifts[i][2]}}
                    </div>
                    <div class="col">
                        <strong>Number of People: </strong>{{shifts[i][3]}}
                    </div>
                    <div class="col">
                        <button type="submit" name="submit" value="{{i}}" class="btn btn-danger btn-sm"
                            style="margin-bottom: 4px;">Remove</button><br>
                    </div>
                </div>
            </form>
            {% endfor %}
            {% else %}
            <p> No current shifts for <strong>{{groupname}}</strong></p>
            {% endif %}
            <hr>
            <h2 class="mb-3"> Add a new shift for {{groupname}}</h2>
            <form action='' method="post">
                <table>
                    <tr>
                        <td>
                            <label for="day">Choose a day:</label>
                        </td>
                        <td>
                            <select name="day" id="day">
                                <option value="Monday">Monday</option>
                                <option value="Tuesday">Tuesday</option>
                                <option value="Wednesday">Wednesday</option>
                                <option value="Thursday">Thursday</option>
                                <option value="Friday">Friday</option>
                                <option value="Saturday">Saturday</option>
                                <option value="Sunday">Sunday</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <label for="start">Choose start:</label>
                        </td>
                        <td>
                            <input type="time" id="start" name="start" step=3600 required>
                        </td>
                    </tr>
                    <tr>
                        <td> <label for="end">Choose end:</label>
                        </td>
                        <td>
                            <input type="time" id="end" name="end" step=3600 required>
                        </td>
                    </tr>
                    <tr>
                        <td style="padding-right: 5px;">
                            <label for="npeople">Number of People: </label>
                        </td>
                        <td>
                            <input type="number" id="npeople" name="npeople" required>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <input type="submit" name="submit" value="Add" class="btn btn-primary btn-sm">
                        </td>
                    </tr>
                </table>
            </form>
            <hr>
            <span id="schedule"></span>
            <h2 class="mb-3">Create Schedule</h2>
            Create schedule for shifts listed above, based on group members' weekly preferences. <br>
            This will replace the current schedule below. <br>
            Once the new schedule is created, each group member's weekly group preferences will reset to their
            global preferences.
            <br>
            <form action="" method="post">
                <input type="submit" name="submit" value="Generate Schedule" class="btn btn-primary btn-sm"
                    style="margin-top: 4px;">
            </form>
            {% if schednotif %}
            <div class="container" style="position: fixed; bottom: 0; left: 20px; margin-bottom: 10px; width: 30%;">
                <div class="alert alert-success alert-dismissible" role="alert">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <strong>New Schedule Generated!</strong><br> Your new schedule is now displayed in Current Schedule.
                </div>
            </div>
            {% endif %}
            <hr>
            <h2 class="mb-3">Current Schedule</h2>
            {% if currsched is not none %}
            {% for shift in currsched %}
            <strong>{{shift}}</strong>:
            {% for netid in currsched[shift] %}
            {{netid}}{% if loop.index < currsched[shift]|length %},{% endif %}
            {% endfor %}
            <br>
            {% endfor %}
            {% else %}
            <p>A new schedule could not be generated based on current shift demands and user preferences. <br>
                Make sure that you've included at least one shift, or try decreasing the number of people per shift.
            </p>
            {% endif %}
            <hr>
            <h2 class="mb-3">Edit Group Members</h2>
            <form action='' method="post">
                <table>
                    <tr>
                        <td><input type="checkbox" disabled checked></td>
                        <td> &nbsp;{{username}} {% if isOwner %} <span class="text-muted"> (owner)</span>
                            {% else %} <span class="text-muted"> (manager)</span>
                            {% endif %}</td>
                    </tr>
                    {% for user in users: %}
                    <tr>
                        <td><input type="checkbox" name={{user}} {% if mgrs[user][1] %} disabled {% endif %}
                                {% if selected[user] %} checked {% endif %}></td>
                        <td> &nbsp;{{user}} {% if mgrs[user][1] %} <span class="text-muted"> ({{mgrs[user][0]}})</span>
                            {% endif %}</td>
                    </tr>
                    {% endfor %}
                </table>
                <input type="submit" name="submit" value="Save" class="btn btn-primary btn-sm" style="margin-top: 4px;">
            </form>
            <hr>
            <h2 class="mb-3">Delete Group</h2>
            <form action='' method="post">
                <input type="submit" name="submit" value="Delete" class="btn btn-primary btn-sm">
            </form>
            <br>
        </div>
    </div>
    {% include 'footer.html' %}

    <!-- Bootstrap core JavaScript -->
    <script src="../static/vendor/jquery/jquery.min.js"></script>
    <script src="../static/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

</body>

</html>